Những sai sót RCE nghiêm trọng ảnh hưởng đến VMware ESXi và vSphere Client – Vá lỗ hổng ngay
VMware đã giải quyết nhiều lỗ hổng RCE nghiêm trọng trong VMware ESXi và nền tảng quản lý cơ sở hạ tầng ảo vSphere Client cái mà có thể cho phép kẻ tấn công thực thi bất kỳ câu lệnh nào và kiểm soát các hệ thống bị ảnh hưởng.
Tác giả mã độc có quyền truy cập network với port 443 có thể khai thác lỗi này để thực thi các lệnh với không giới hạn quyền trên hệ điều hành host của vCenter Server.
Lỗ hổng bảo mật, được theo dõi là CVE-2021021972, có điểm CVSS là 9.8 trên tổng số tối đa là 10, khiến nó trở nên nghiêm trọng về mức độ nghiêm trọng.
“Theo quan điểm của chúng tôi, lỗ hổng RCE trong vCenter Server có thể gây ra mối đe dọa không kém so với lỗ hổng nổi tiêng trong Citrix (CVE-2019-19781), người đã tìm ra và báo cáo sai sót đến VMware.
Lỗi này cho phép người dùng không cần xác thực để gửi yêu cầu thủ công đặc biệt, cái mà sau đó sẽ đem lại cho họ cơ hội tốt để thực thi lệnh bất kỳ trên server.
Với quyền truy cập tại chỗ này, kẻ tấn công sau đó có thể di chuyển thành công thông qua mạng công ty và thu được quyền truy cập vào dữ liệu được lưu trữ trong hệ thống chứa lỗ hổng, chẳng hạn như thong tin về máy ảo và người dùng trong hệ thống.
Riêng biệt, lỗ hổng thứ hai (CVE-2021-21973, CVSS điểm 5.3) cho phép user không cần xác thực để gửi yêu cầu POST, cho phép kẻ tấn công tấn công thêm, bao gồm khả năng để quét trong mạng nội bộ của công ty và truy xuất cụ thể về các ports đang mở của các dịch vụ.
Vấn đề công bố thong tin, theo VMware, bắt nguồn từ SSRF do xác thực URL trong plugin vCenter Server không đúng cách.
VMware cũng đã cung cấp các giải pháp thay thế để khắc phục tạm thời CVE-2021-21972 và CVE-2021-21973 cho đến khi bản cập nhật có thể được triển khai. Các bước chi tiết có thể tìm kiếm tại trang chủ của VMWare.
Cần lưu ý rằng VMware đã khắc phục lỗ hổng chèn lệnh trong sản phẩm vSphere Replication của mình vào đầu tháng đây có thể cung cấp cho một tác nhân xấu với quyền quản trị để thực thi lệnh shell và đạt được RCE.
Cuối cùng, VMware cũng đã giải quyết lỗi tràn bộ đệm heap trong ESXi’s giao thức SLP, có tiềm năng cho phép kẻ tấn công trong cùng một mạng gửi mã độc SLP yêu cầu đến thiết bị ESXi và kiểm soát nó.
OpenSLP cung cấp framework cho phép các ứng dụng network tìm kiếm sự tồn tại, vị trí, và cấu hình của các dịch vụ nối mạng trong mạng doanh nghiệp.
Bản sửa lỗi mới nhất cho ESXi OpenSLP xuất hiện sau bản vá tương tự (CVE-2020-3992) vào tháng 11 năm ngoái có thể được tận dụng để kích hoạt tính năng use-after-free trong dịch vụ OpenSLP, dẫn đến RCE.
Không lâu sau đó, báo cáo về các nỗ lực khai thác tích cực xuất hiện in the wild, với các nhóm ransomeware lạm dụng lỗ hổng bảo mật để tiếp nhận bản vá VM được phát hành trong môi trường enterprise và các thiết bị phần cứng ảo mã hóa của chúng.
Khuyến nghị đặc biệt đến các người dùng bên cài đặt các bản cập nhật để loại bỏ rủi ro liên quan đến các sai sót, ngoài việc “ loại bỏ các vCenter Server interface khỏi phạm vi của tổ chức. Nếu vCenter Server được sử dụng hãy phân bổ chúng vào một VLAN riêng biệt với danh sách truy cập hạn chế trong mạng nội bộ. 
